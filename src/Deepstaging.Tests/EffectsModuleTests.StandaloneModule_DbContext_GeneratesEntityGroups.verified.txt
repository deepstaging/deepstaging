// <auto-generated/>
#nullable enable
namespace TestApp;
public interface IHasAppDb
{
    public global::TestApp.AppDbContext AppDbContext { get; }
}

// <auto-generated/>
#nullable enable

using System.Diagnostics;
using System.Linq.Expressions;
using LanguageExt;
using LanguageExt.Effects;
using Microsoft.EntityFrameworkCore;
using static LanguageExt.Prelude;
using Deepstaging.Effects;

namespace TestApp;

/// <summary>
/// Effect methods for AppDbContext.
/// Provides DbContext-level methods and nested entity groups for each DbSet.
/// </summary>
public static partial class AppDbEffects
{
    private static readonly ActivitySource _activitySource = 
        new("TestApp.AppDbEffects", "1.0.0");
    
    // ========== DbContext-Level Methods ==========
    
    /// <summary>
    /// Saves all changes made in this context to the database.
    /// </summary>
    public static Eff<RT, int> SaveChangesAsync<RT>(CancellationToken token = default) where RT : IHasAppDb =>
        liftEff<RT, int>(async rt => 
            await rt.AppDbContext.SaveChangesAsync(token))
        .WithActivity("AppDb.SaveChangesAsync", _activitySource);
    
    // ========== User Entity Group ==========
    
    /// <summary>
    /// Query builder and effects for global::TestApp.User entities.
    /// </summary>
    public static partial class Users
    {
        /// <summary>
        /// Returns a composable query builder for this entity set.
        /// Chain LINQ methods and call a terminal operation (ToListAsync, FirstOrNoneAsync, etc.) to execute.
        /// </summary>
        public static DbSetQuery<RT, global::TestApp.User> Query<RT>() where RT : IHasAppDb =>
            new(rt => rt.AppDbContext.Users);
        
        // ========== Convenience Methods ==========
        
        /// <summary>
        /// Finds an entity by its primary key values, returning None if not found.
        /// </summary>
        public static Eff<RT, Option<global::TestApp.User>> FindAsync<RT>(params object[] keyValues) where RT : IHasAppDb =>
            liftEff<RT, Option<global::TestApp.User>>(async rt =>
                Optional(await rt.AppDbContext.Users.FindAsync(keyValues)))
            .WithActivity("AppDb.Users.FindAsync", _activitySource);
        
        /// <summary>
        /// Returns all entities as a list.
        /// </summary>
        public static Eff<RT, List<global::TestApp.User>> ToListAsync<RT>(CancellationToken token = default) where RT : IHasAppDb =>
            Query<RT>().ToListAsync(token)
            .WithActivity("AppDb.Users.ToListAsync", _activitySource);
        
        /// <summary>
        /// Returns the first entity matching the predicate, or None.
        /// </summary>
        public static Eff<RT, Option<global::TestApp.User>> FirstOrNoneAsync<RT>(
            Expression<Func<global::TestApp.User, bool>> predicate,
            CancellationToken token = default) where RT : IHasAppDb =>
            Query<RT>().FirstOrNoneAsync(predicate, token)
            .WithActivity("AppDb.Users.FirstOrNoneAsync", _activitySource);
        
        /// <summary>
        /// Returns the count of entities matching the optional predicate.
        /// </summary>
        public static Eff<RT, int> CountAsync<RT>(CancellationToken token = default) where RT : IHasAppDb =>
            Query<RT>().CountAsync(token)
            .WithActivity("AppDb.Users.CountAsync", _activitySource);
        
        /// <summary>
        /// Returns true if any entities match the optional predicate.
        /// </summary>
        public static Eff<RT, bool> AnyAsync<RT>(CancellationToken token = default) where RT : IHasAppDb =>
            Query<RT>().AnyAsync(token)
            .WithActivity("AppDb.Users.AnyAsync", _activitySource);
        
        // ========== Modification Methods ==========
        
        /// <summary>
        /// Begins tracking the entity in the Added state.
        /// </summary>
        public static Eff<RT, Unit> Add<RT>(global::TestApp.User entity) where RT : IHasAppDb =>
            liftEff<RT, Unit>(rt =>
            {
                rt.AppDbContext.Users.Add(entity);
                return unit;
            })
            .WithActivity("AppDb.Users.Add", _activitySource);
        
        /// <summary>
        /// Begins tracking the entities in the Added state.
        /// </summary>
        public static Eff<RT, Unit> AddRange<RT>(params global::TestApp.User[] entities) where RT : IHasAppDb =>
            liftEff<RT, Unit>(rt =>
            {
                rt.AppDbContext.Users.AddRange(entities);
                return unit;
            })
            .WithActivity("AppDb.Users.AddRange", _activitySource);
        
        /// <summary>
        /// Begins tracking the entity in the Modified state.
        /// </summary>
        public static Eff<RT, Unit> Update<RT>(global::TestApp.User entity) where RT : IHasAppDb =>
            liftEff<RT, Unit>(rt =>
            {
                rt.AppDbContext.Users.Update(entity);
                return unit;
            })
            .WithActivity("AppDb.Users.Update", _activitySource);
        
        /// <summary>
        /// Begins tracking the entity in the Deleted state.
        /// </summary>
        public static Eff<RT, Unit> Remove<RT>(global::TestApp.User entity) where RT : IHasAppDb =>
            liftEff<RT, Unit>(rt =>
            {
                rt.AppDbContext.Users.Remove(entity);
                return unit;
            })
            .WithActivity("AppDb.Users.Remove", _activitySource);
    }
    
    // ========== Order Entity Group ==========
    
    /// <summary>
    /// Query builder and effects for global::TestApp.Order entities.
    /// </summary>
    public static partial class Orders
    {
        /// <summary>
        /// Returns a composable query builder for this entity set.
        /// Chain LINQ methods and call a terminal operation (ToListAsync, FirstOrNoneAsync, etc.) to execute.
        /// </summary>
        public static DbSetQuery<RT, global::TestApp.Order> Query<RT>() where RT : IHasAppDb =>
            new(rt => rt.AppDbContext.Orders);
        
        // ========== Convenience Methods ==========
        
        /// <summary>
        /// Finds an entity by its primary key values, returning None if not found.
        /// </summary>
        public static Eff<RT, Option<global::TestApp.Order>> FindAsync<RT>(params object[] keyValues) where RT : IHasAppDb =>
            liftEff<RT, Option<global::TestApp.Order>>(async rt =>
                Optional(await rt.AppDbContext.Orders.FindAsync(keyValues)))
            .WithActivity("AppDb.Orders.FindAsync", _activitySource);
        
        /// <summary>
        /// Returns all entities as a list.
        /// </summary>
        public static Eff<RT, List<global::TestApp.Order>> ToListAsync<RT>(CancellationToken token = default) where RT : IHasAppDb =>
            Query<RT>().ToListAsync(token)
            .WithActivity("AppDb.Orders.ToListAsync", _activitySource);
        
        /// <summary>
        /// Returns the first entity matching the predicate, or None.
        /// </summary>
        public static Eff<RT, Option<global::TestApp.Order>> FirstOrNoneAsync<RT>(
            Expression<Func<global::TestApp.Order, bool>> predicate,
            CancellationToken token = default) where RT : IHasAppDb =>
            Query<RT>().FirstOrNoneAsync(predicate, token)
            .WithActivity("AppDb.Orders.FirstOrNoneAsync", _activitySource);
        
        /// <summary>
        /// Returns the count of entities matching the optional predicate.
        /// </summary>
        public static Eff<RT, int> CountAsync<RT>(CancellationToken token = default) where RT : IHasAppDb =>
            Query<RT>().CountAsync(token)
            .WithActivity("AppDb.Orders.CountAsync", _activitySource);
        
        /// <summary>
        /// Returns true if any entities match the optional predicate.
        /// </summary>
        public static Eff<RT, bool> AnyAsync<RT>(CancellationToken token = default) where RT : IHasAppDb =>
            Query<RT>().AnyAsync(token)
            .WithActivity("AppDb.Orders.AnyAsync", _activitySource);
        
        // ========== Modification Methods ==========
        
        /// <summary>
        /// Begins tracking the entity in the Added state.
        /// </summary>
        public static Eff<RT, Unit> Add<RT>(global::TestApp.Order entity) where RT : IHasAppDb =>
            liftEff<RT, Unit>(rt =>
            {
                rt.AppDbContext.Orders.Add(entity);
                return unit;
            })
            .WithActivity("AppDb.Orders.Add", _activitySource);
        
        /// <summary>
        /// Begins tracking the entities in the Added state.
        /// </summary>
        public static Eff<RT, Unit> AddRange<RT>(params global::TestApp.Order[] entities) where RT : IHasAppDb =>
            liftEff<RT, Unit>(rt =>
            {
                rt.AppDbContext.Orders.AddRange(entities);
                return unit;
            })
            .WithActivity("AppDb.Orders.AddRange", _activitySource);
        
        /// <summary>
        /// Begins tracking the entity in the Modified state.
        /// </summary>
        public static Eff<RT, Unit> Update<RT>(global::TestApp.Order entity) where RT : IHasAppDb =>
            liftEff<RT, Unit>(rt =>
            {
                rt.AppDbContext.Orders.Update(entity);
                return unit;
            })
            .WithActivity("AppDb.Orders.Update", _activitySource);
        
        /// <summary>
        /// Begins tracking the entity in the Deleted state.
        /// </summary>
        public static Eff<RT, Unit> Remove<RT>(global::TestApp.Order entity) where RT : IHasAppDb =>
            liftEff<RT, Unit>(rt =>
            {
                rt.AppDbContext.Orders.Remove(entity);
                return unit;
            })
            .WithActivity("AppDb.Orders.Remove", _activitySource);
    }
    
}
