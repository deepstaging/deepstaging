// <auto-generated/>
// SPDX-License-Identifier: RPL-1.5
// Copyright (c) Deepstaging contributors. All rights reserved.
// Licensed under the Reciprocal Public License 1.5 (RPL-1.5).
// See LICENSE file in the project root for full license information.
#nullable enable
using Deepstaging.Effects;
using LanguageExt;
using LanguageExt.Effects;
using Microsoft.EntityFrameworkCore;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Threading;
using System.Threading.Tasks;
using static LanguageExt.Prelude;

namespace TestApp;
/// <summary>
/// Container class for the <c>Database</c> effects module and its nested entity set effect classes.
/// </summary>
public static partial class MyEffects
{
    public static partial class Database
    {
        private static readonly ActivitySource ActivitySource = new("TestApp.Database", "1.0.0");
        /// <summary>
        /// Saves all changes made in this context to the database asynchronously.
        /// </summary>
        /// <typeparam name="RT">The runtime type providing database context access.</typeparam>
        /// <param name="token">A cancellation token to observe while waiting for the task to complete.</param>
        /// <returns>An effect that yields the number of state entries written to the database.</returns>
        public static Eff<RT, int> SaveChangesAsync<RT>(CancellationToken token = default)
            where RT : IHasAppDbContext => liftEff<RT, int>(async rt => await rt.AppDbContext.SaveChangesAsync(token)).WithActivity("Database.SaveChangesAsync", ActivitySource);
        /// <summary>
        /// Effect methods for the <c>Users</c> entity set.
        /// </summary>
        public static partial class Users
        {
            /// <summary>
            /// Returns a composable query builder for this entity set.
            /// Chain LINQ methods and call a terminal operation (ToListAsync, FirstOrNoneAsync, etc.) to execute.
            /// </summary>
            /// <typeparam name="RT">The runtime type providing database context access.</typeparam>
            /// <returns>A composable query builder for the entity set.</returns>
            public static DbSetQuery<RT, global::TestApp.User> Query<RT>()
                where RT : IHasAppDbContext => new(rt => rt.AppDbContext.Users);
            /// <summary>
            /// Finds an entity by its primary key values, returning None if not found.
            /// </summary>
            /// <typeparam name="RT">The runtime type providing database context access.</typeparam>
            /// <param name="keyValues">The primary key values of the entity to find.</param>
            /// <returns>An effect that yields the entity wrapped in an Option, or None if not found.</returns>
            public static Eff<RT, Option<global::TestApp.User>> FindAsync<RT>(params object[] keyValues)
                where RT : IHasAppDbContext => liftEff<RT, Option<global::TestApp.User>>(async rt => Optional(await rt.AppDbContext.Users.FindAsync(keyValues))).WithActivity("Database.Users.FindAsync", ActivitySource);
            /// <summary>
            /// Returns all entities as a list.
            /// </summary>
            /// <typeparam name="RT">The runtime type providing database context access.</typeparam>
            /// <param name="token">A cancellation token to observe while waiting for the task to complete.</param>
            /// <returns>An effect that yields a list of all entities.</returns>
            public static Eff<RT, global::System.Collections.Generic.List<global::TestApp.User>> ToListAsync<RT>(CancellationToken token = default)
                where RT : IHasAppDbContext => Query<RT>().ToListAsync(token).WithActivity("Database.Users.ToListAsync", ActivitySource);
            /// <summary>
            /// Returns the first entity matching the predicate, or None.
            /// </summary>
            /// <typeparam name="RT">The runtime type providing database context access.</typeparam>
            /// <param name="predicate">The LINQ expression representing the filter condition.</param>
            /// <param name="token">A cancellation token to observe while waiting for the task to complete.</param>
            /// <returns>An effect that yields the matching entity wrapped in an Option, or None if not found.</returns>
            public static Eff<RT, Option<global::TestApp.User>> FirstOrNoneAsync<RT>(global::System.Linq.Expressions.Expression<global::System.Func<global::TestApp.User, bool>> predicate, CancellationToken token = default)
                where RT : IHasAppDbContext => Query<RT>().FirstOrNoneAsync(predicate, token).WithActivity("Database.Users.FirstOrNoneAsync", ActivitySource);
            /// <summary>
            /// Returns the count of entities.
            /// </summary>
            /// <typeparam name="RT">The runtime type providing database context access.</typeparam>
            /// <param name="token">A cancellation token to observe while waiting for the task to complete.</param>
            /// <returns>An effect that yields the number of entities.</returns>
            public static Eff<RT, int> CountAsync<RT>(CancellationToken token = default)
                where RT : IHasAppDbContext => Query<RT>().CountAsync(token).WithActivity("Database.Users.CountAsync", ActivitySource);
            /// <summary>
            /// Returns true if any entities exist.
            /// </summary>
            /// <typeparam name="RT">The runtime type providing database context access.</typeparam>
            /// <param name="token">A cancellation token to observe while waiting for the task to complete.</param>
            /// <returns>An effect that yields &lt;see langword=&quot;true&quot; /&gt; if the entity set contains any elements.</returns>
            public static Eff<RT, bool> AnyAsync<RT>(CancellationToken token = default)
                where RT : IHasAppDbContext => Query<RT>().AnyAsync(token).WithActivity("Database.Users.AnyAsync", ActivitySource);
            /// <summary>
            /// Begins tracking the entity in the Added state so it will be inserted on SaveChanges.
            /// </summary>
            /// <typeparam name="RT">The runtime type providing database context access.</typeparam>
            /// <param name="entity">The entity to add.</param>
            /// <returns>An effect that yields the tracked entity.</returns>
            public static Eff<RT, global::TestApp.User> Add<RT>(global::TestApp.User entity)
                where RT : IHasAppDbContext => liftEff<RT, global::TestApp.User>(rt =>
            {
                rt.AppDbContext.Users.Add(entity);
                return entity;
            }).WithActivity("Database.Users.Add", ActivitySource);
            /// <summary>
            /// Begins tracking the entities in the Added state so they will be inserted on SaveChanges.
            /// </summary>
            /// <typeparam name="RT">The runtime type providing database context access.</typeparam>
            /// <param name="entities">The entities to add.</param>
            /// <returns>An effect that yields the tracked entities.</returns>
            public static Eff<RT, global::TestApp.User[]> AddRange<RT>(params global::TestApp.User[] entities)
                where RT : IHasAppDbContext => liftEff<RT, global::TestApp.User[]>(rt =>
            {
                rt.AppDbContext.Users.AddRange(entities);
                return entities;
            }).WithActivity("Database.Users.AddRange", ActivitySource);
            /// <summary>
            /// Begins tracking the entity in the Modified state so it will be updated on SaveChanges.
            /// </summary>
            /// <typeparam name="RT">The runtime type providing database context access.</typeparam>
            /// <param name="entity">The entity to update.</param>
            /// <returns>An effect that yields the tracked entity.</returns>
            public static Eff<RT, global::TestApp.User> Update<RT>(global::TestApp.User entity)
                where RT : IHasAppDbContext => liftEff<RT, global::TestApp.User>(rt =>
            {
                rt.AppDbContext.Users.Update(entity);
                return entity;
            }).WithActivity("Database.Users.Update", ActivitySource);
            /// <summary>
            /// Begins tracking the entity in the Deleted state so it will be removed on SaveChanges.
            /// </summary>
            /// <typeparam name="RT">The runtime type providing database context access.</typeparam>
            /// <param name="entity">The entity to remove.</param>
            /// <returns>An effect that yields the removed entity.</returns>
            public static Eff<RT, global::TestApp.User> Remove<RT>(global::TestApp.User entity)
                where RT : IHasAppDbContext => liftEff<RT, global::TestApp.User>(rt =>
            {
                rt.AppDbContext.Users.Remove(entity);
                return entity;
            }).WithActivity("Database.Users.Remove", ActivitySource);
        }
    }
}